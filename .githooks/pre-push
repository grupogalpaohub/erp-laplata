#!/usr/bin/env bash
set -e
export GIT_STAGED_LIST="$(git diff --cached --name-only; echo; git diff --name-only)"
node scripts/guardrails/enforce.mjs --mode=push
node -e "try{require.resolve('js-yaml');}catch(e){process.exit(1)}" || npm i -D js-yaml glob >/dev/null 2>&1
node scripts/guardrails/regression-check.js
echo 'âœ… pre-push aprovado.'